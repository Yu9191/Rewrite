(()=>{const $=(()=>{const S=typeof $persistentStore!="undefined",Q=typeof $prefs!="undefined",R=(k)=>S?$persistentStore.read(k):Q?$prefs.valueForKey(k):"",W=(v,k)=>S?$persistentStore.write(v,k):Q?$prefs.setValueForKey(v,k):"",N=(t,s,b,o)=>Q?$notify(t,s,b,o):$notification.post(t,s,b,o),H={get:o=>new Promise((res,rej)=>{Q?$task.fetch(o).then(d=>res({body:d.body})).catch(rej):$httpClient.get(o,(e,r,b)=>e?rej(e):res({body:b}))})};return{getdata:R,setdata:W,msg:N,http:H,done:v=>$done(v)}})();(async()=>{try{let u=$request.url,h=$request.headers||{};u=u.replace(/\/\/(?!long\.)[^\/.]+\./,"//long.");if(h["x-playback-session-id"]||h["X-Playback-Session-Id"]||/\.m3u8(\?|$)/i.test(u)){if($.getdata("m3u8")!==u){$.setdata(u,"m3u8");const open="SenPlayer://x-callback-url/play?url="+encodeURIComponent(u);try{const{body}=await $.http.get({url:"https://www.ikanins.com/inkyung97-2/",headers:{"User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 15_1_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.1 Mobile/15E148 Safari/604.1",Accept:"text/html"}}),imgs=[...body.matchAll(/<img[^>]+?src="([^">]+)"/gi)].map(m=>m[1]);let img=imgs.length?imgs[new Date().getMinutes()%imgs.length]:"";/^https?:\/\//.test(img)||(img="https://www.ikanins.com"+img);$.msg("av获取成功","新的视频链接已捕获","点击下方查看视频链接",{"open-url":open,"media-url":img})}catch{$.msg("av获取成功","新的视频链接已捕获","点击下方查看视频链接",{"open-url":open})}}}}catch(e){console.log("脚本错误:",e)}finally{$.done({})}})();})();
